@if (!isRequestSent()) {
<div class="flex flex-col animate-in fade-in duration-500">
  <header class="flex flex-col items-center mb-8">
    <div
      class="size-16 bg-blue-50 rounded-full flex items-center justify-center mb-4 text-blue-600 shadow-sm"
    >
      <span class="material-symbols-outlined text-4xl">lock_reset</span>
    </div>
    <h1 class="text-slate-900 text-3xl font-black tracking-tight text-center">
      Reset Password
    </h1>
    <p class="text-slate-500 text-base text-center mt-3 max-w-[320px]">
      Enter your email and we'll send you a link to get back into your account.
    </p>
  </header>

  <form
    class="flex flex-col gap-5"
    [formGroup]="form"
    (ngSubmit)="doSubmit()"
    novalidate
  >
    <div class="flex flex-col gap-2">
      <label class="text-sm font-bold text-slate-700" for="recovery-email"
        >Email Address</label
      >
      <span class="p-input-icon-left w-full">
        <i class="pi pi-envelope"></i>
        <input
          pInputText
          id="recovery-email"
          type="email"
          formControlName="email"
          placeholder="name@example.com"
          class="w-full"
          [invalid]="form.controls.email.invalid && form.controls.email.touched"
        />
      </span>
      <app-form-validation-error
        [touched]="form.controls.email.touched"
        [errors]="form.controls.email.errors"
        label="Email"
      />
    </div>

    <div
      class="flex justify-center items-center gap-1 text-sm bg-slate-50 p-2 rounded-lg"
    >
      <span class="text-slate-500">Already have a code?</span>
      <p-button
        link
        label="Click here"
        [routerLink]="['/auth/password-recovery-confirm']"
        styleClass="p-0 text-sm font-bold"
      />
    </div>

    <app-form-feedback [callState]="store.callState()" />

    <p-button
      type="submit"
      label="Send Reset Link"
      styleClass="w-full py-3"
      [loading]="store.loading()"
    />

    <p-button
      link
      label="Back to Login"
      icon="pi pi-arrow-left"
      [routerLink]="['/auth/login']"
      styleClass="w-full text-slate-500"
    />
  </form>
</div>
} @else {
<div
  class="flex flex-col items-center py-6 animate-in zoom-in duration-300"
  role="alert"
>
  <div
    class="size-20 bg-emerald-100 rounded-full flex items-center justify-center mb-6 text-emerald-600 shadow-inner"
  >
    <span class="material-symbols-outlined text-5xl">mark_email_read</span>
  </div>
  <h2 class="text-slate-900 text-2xl font-bold text-center">
    Check your Email
  </h2>
  <p class="text-slate-500 text-base text-center mt-4">
    We've sent a recovery link to:<br />
    <b class="text-slate-900">{{ form.controls.email.value }}</b>
  </p>

  <div class="mt-8 flex flex-col gap-6 w-full text-center">
    <div
      class="text-sm text-slate-500 bg-slate-50 p-4 rounded-xl border border-slate-100"
    >
      Didn't get the email?
      <button
        (click)="doSubmit()"
        class="text-blue-600 font-bold hover:underline"
      >
        Resend link
      </button>
    </div>

    <p-button
      link
      label="Back to Login"
      icon="pi pi-arrow-left"
      [routerLink]="['/auth/login']"
    />
  </div>
</div>
}

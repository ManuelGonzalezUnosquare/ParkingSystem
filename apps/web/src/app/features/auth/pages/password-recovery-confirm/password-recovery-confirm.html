<div class="flex flex-col">
  <!-- header -->
  <div class="flex flex-col items-center mb-8">
    <div
      class="size-16 bg-primary/10 rounded-full flex items-center justify-center mb-4 text-primary"
    >
      <span class="material-symbols-outlined text-4xl">lock_reset</span>
    </div>
    <h1
      class="text-[#0d141c] tracking-light text-[32px] font-bold leading-tight text-center"
    >
      Reset Your Password
    </h1>
    <p
      class="text-[#4b739b] text-base font-normal leading-normal text-center mt-3"
    >
      Enter the email address associated with your account and we'll send you a
      link to reset your password.
    </p>
  </div>

  @if(step() === 1){
  <!-- form -->
  <form class="flex flex-col" [formGroup]="codeForm" (submit)="doSubmitCode()">
    <div class="form-control">
      <label class="form-label" for="code">Recovery code</label>
      <input
        fluid
        formControlName="code"
        id="code"
        pInputText
        placeholder="AO$@$%"
        [invalid]="codeForm.controls.code.invalid && codeForm.controls.code.touched"
      />
      <app-form-validation-error
        [touched]="codeForm.controls.code.touched"
        [errors]="codeForm.controls.code.errors"
        label="Password"
      />
    </div>

    <app-form-feedback [callState]="store.callState()" />

    <div class="pt-4">
      <p-button
        type="submit"
        label="Send code"
        fluid
        [loading]="store.loading()"
      />
    </div>
    <div class="text-center mt-4">
      <p-button
        link
        label="Back to Login"
        icon="pi pi-arrow-left"
        [routerLink]="['/auth/login']"
      />
    </div>
  </form>

  } @if(step() === 2){

  <!-- form -->
  <form
    class="flex flex-col space-y-4"
    [formGroup]="passwordForm"
    (submit)="doSubmitPassword()"
  >
    <!-- password -->
    <div class="form-control">
      <label class="form-label" for="password">Password</label>
      <input
        autocomplete="off"
        fluid
        formControlName="password"
        id="password"
        pInputText
        placeholder="********"
        type="password"
        [invalid]="passwordForm.controls.password.invalid && passwordForm.controls.password.touched"
      />
      <app-form-validation-error
        [touched]="passwordForm.controls.password.touched"
        [errors]="passwordForm.controls.password.errors"
        label="Password"
      />
    </div>

    <!-- confirm password -->
    <div class="form-control">
      <label class="form-label" for="confirmPassword">Confirm Password</label>
      <input
        autocomplete="off"
        fluid
        formControlName="confirmPassword"
        id="confirmPassword"
        pInputText
        placeholder="********"
        type="password"
        [invalid]="passwordForm.controls.confirmPassword.invalid && passwordForm.controls.confirmPassword.touched"
      />
      <app-form-validation-error
        [touched]="passwordForm.controls.confirmPassword.touched"
        [errors]="passwordForm.controls.confirmPassword.errors"
        label="Confirm Password"
      />
    </div>

    <app-form-feedback [callState]="store.callState()" />

    <div class="pt-4">
      <p-button
        type="submit"
        label="Change password"
        fluid
        [loading]="store.loading()"
      />
    </div>
    <div class="text-center mt-4">
      <p-button
        link
        label="Back to Login"
        icon="pi pi-arrow-left"
        [routerLink]="['/auth/login']"
      />
    </div>
  </form>
  }
</div>

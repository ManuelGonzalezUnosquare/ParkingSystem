<p-confirmDialog />
<!-- header -->
<header class="flex items-center justify-between">
  <app-page-header
    title="Buildings"
    subTitle="Manage infrastructure and system administrators."
  />
  <p-button
    label="New Building"
    icon="pi pi-plus"
    (click)="add()"
    styleClass="p-button-raised"
  />
</header>

<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
  <p-card>
    <ng-template #title>
      <div class="flex justify-between items-start">
        <p
          id="card-label"
          class="text-[#4b739b] text-xs font-bold uppercase tracking-widest"
        >
          Total Buildings
        </p>
        <i class="pi pi-building text-blue-500" aria-hidden="true"></i>
      </div>
    </ng-template>

    <ng-template #subtitle>
      <div class="flex flex-col" [attr.aria-labelledby]="'card-label'">
        <p
          class="text-[#0d141c] tracking-tight text-4xl font-extrabold leading-tight"
        >
          {{buildingStore.pagination()?.total || 0}}
        </p>
        <p class="text-slate-500 text-sm font-medium">Lorem ipsum dolor ...</p>
      </div>
    </ng-template>
  </p-card>

  <p-card>
    <div class="text-center">
      <span class="text-gray-400">placeholder card</span>
    </div>
  </p-card>
  <p-card>
    <div class="text-center">
      <span class="text-gray-400">placeholder card</span>
    </div>
  </p-card>
</div>

<p-card>
  <p-table
    #dt
    [value]="buildingStore.entities()"
    [lazy]="true"
    (onLazyLoad)="onLazyLoad($event)"
    [paginator]="true"
    [rows]="10"
    [totalRecords]="buildingStore.pagination()?.total || 0"
    [loading]="buildingStore.isLoading()"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords}"
    [rowsPerPageOptions]="[10, 20, 50]"
  >
    <ng-template pTemplate="caption">
      <div class="flex flex-col md:flex-row justify-between items-center gap-4">
        <h3 class="text-lg font-bold text-slate-700">
          Infrastructure Inventory
        </h3>
        <span class="p-input-icon-left w-full md:w-80">
          <input
            pInputText
            class="w-full"
            placeholder="Search by name or address..."
            (input)="dt.filterGlobal($any($event.target).value, 'contains')"
          />
        </span>
      </div>
    </ng-template>

    <ng-template #header>
      <tr>
        <th
          pSortableColumn="name"
          class="bg-slate-50 text-xs font-bold uppercase text-slate-600"
        >
          Name <p-sortIcon field="name" />
        </th>
        <th
          pSortableColumn="address"
          class="bg-slate-50 text-xs font-bold uppercase text-slate-600"
        >
          Address <p-sortIcon field="address" />
        </th>
        <th
          pSortableColumn="totalSlots"
          class="bg-slate-50 text-xs font-bold uppercase text-slate-600 w-32 text-center"
        >
          Spots <p-sortIcon field="totalSlots" />
        </th>
        <th
          class="bg-slate-50 text-xs font-bold uppercase text-slate-600 w-40 text-center"
        >
          Actions
        </th>
      </tr>
    </ng-template>

    <ng-template #body let-building>
      <tr class="hover:bg-blue-50/30 transition-colors">
        <td class="text-sm font-semibold text-slate-700">
          {{ building.name }}
        </td>
        <td class="text-sm text-slate-600">{{ building.address }}</td>
        <td class="text-sm text-center font-mono font-bold">
          {{ building.totalSlots }}
        </td>
        <td>
          <div class="flex justify-center gap-1">
            <p-button
              icon="pi pi-eye"
              [text]="true"
              severity="info"
              (click)="viewDetails(building)"
              pTooltip="View Details"
            />
            <p-button
              icon="pi pi-pencil"
              [text]="true"
              severity="secondary"
              (click)="update(building)"
              pTooltip="Edit Building"
            />
            <p-button
              icon="pi pi-trash"
              [text]="true"
              severity="danger"
              (click)="remove(building)"
              pTooltip="Delete Building"
            />
          </div>
        </td>
      </tr>
    </ng-template>

    <ng-template #emptymessage>
      <tr>
        <td colspan="4" class="text-center py-8 text-slate-400">
          <i class="pi pi-building text-4xl mb-3 block"></i>
          No buildings found. Click "New Building" to start.
        </td>
      </tr>
    </ng-template>
  </p-table>
</p-card>

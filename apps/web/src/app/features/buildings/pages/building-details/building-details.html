<header class="flex items-center justify-between">
  @if(store.building(); as building){
  <app-page-header
    [title]="building.name"
    subTitle="Manage parking allocations and resident data for this building."
  />
  <p-button
    label="Trigger Raffle"
    icon="pi pi-bolt"
    (click)="runRaffle()"
    [disabled]="store.residentCount() === 0"
    [loading]="store.isLoading()"
    severity="primary"
  />
  }
</header>

<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
  <app-total-resident-card class="h-full" [users]="store.usersEntities()" />
  <app-vehicles-card class="h-full" [users]="store.usersEntities()" />
  <app-last-raffle-card class="h-full" [raffle]="store.liveRaffle()" />
  <app-utilization-card
    class="h-full"
    [users]="store.usersEntities()"
    [availableSpots]="store.building()?.totalSlots ?? 0"
  />
</div>

<p-card>
  <app-users-table
    [users]="store.usersEntities()"
    [isLoading]="store.loading()"
    [pagination]="store.usersPagination()"
    (add)="openBuildingDialog('Create User')"
    (update)="openBuildingDialog('Update User',$event)"
    (delete)="delete($event)"
    (filter)="search($event)"
  />
</p-card>
